JPA가 없었을 때
![[JPA를 사용하지 않았을 때 구조.jpg]]

### 1. 영속성 컨텍스트

= 엔티티를 영구 저장하는 환경

#### JPA 엔티티의 상태
- 비영속(New) : 영속성 컨택스트와 관계가 없는 새로운 상태
			    해당 객체의 데이터와 실제 DB 데이터는 관련 X

- 영속(Managed) : 엔티티 매니저를 통해 엔티티가
				 영속성 컨텍스트에 저장되어 관리되고 있는 상태
				 데이터의 생성, 변경 등을 JPA가  추적하며 필요시 DB 반영

- 준영속(Detached) : 영속성 컨택스트에서 관리되다가 분리된 상태

- 삭제(Removed) : 영속성 컨택스트에서 삭제된 상태

![[영속성 컨텍스트.jpeg]]

### 2. 영속성 컨텍스트 설계 원인

##### 1차 캐시가 있다.
![[영속성 컨텍스트 구조.jpeg]]
##### "쓰기 지연 SQL 저장소"가 있다!
![[쓰기지연 SQL 저장소.jpeg]]
그림보다 예시로 보는게 낫다.
ex) 1차 캐시 조회가 완료 되면 쓰기지연과 같이 저장
#### DirtyChecking을 통해 데이터 변경을 감지해 자동 수정한다.
![[DirtyChecking을 통해 데이터 자동 수정.jpeg]]
그림보다 예시로 보는게 낫다.
ex) 1차 캐시 변경마다 바로 저장
데이터의 어플리케이션 단의 동일성을 보장해준다.
<참조>JPA 동일성 보장 https://devhyogeon.tistory.com/6
